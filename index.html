<!DOCTYPE html>

<html>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
    <script> 
        $(function(){
          $("#header").load("header.html");
        });
    </script> 
    <div id="header"></div>

    <!-- formulaire login -->
    <div class ='row'>
        <div class="col-lg-offset-4 col-lg-4">
            <div class="well bs-component">
                <legend>Veuillez vous connecter :</legend>
            	<form class="form-horizontal" id="loginForm"> <!--action="/tptwitter/login/" method="post"-->

                    <div class="form-group">
                        <label class="col-lg-2" for="login">Login</label>
                        <div class="col-lg-10">
                            <input type="text" class="form-control" id="login" name="login" autofocus />
                        </div>
                    </div> 

                    <div class="form-group">
                        <label class="col-lg-2" for="passwd">Password</label>

                        <div class="col-lg-10">
                            <input type="password" class="form-control" id="passwd" name="passwd" autofocus />
                            <p class="text-success" id="ResultLogin"> </p>
                        </div>
                    </div>
                    <button class="btn btn-primary btn-lg-2" type="button" onclick="loginCheck()"> Submit </button>

                </form>
            </div>
        </div>
    </div>

    <script>
        function loginCheck(){
           $.ajax({
               url : 'http://localhost:8000/tptwitter/login',
               type : 'POST',
               data : "login=" + $('#login').val() + "&passwd=" + $('#passwd').val(),
               success : function(result){
                    if(result.result){
                        $('#ResultLogin').attr('class', "text-success");
                        /*var form = '';
                        form += '<input type="hidden" name="userid" value="'+ result.userid +'">';
                        form += '<input type="hidden" name="username" value="'+ result.username +'">';
                        $('<form action="/home.html" method="GET">'+form+'</form>').appendTo('body').submit();*/
                        window.location = "http://localhost:8080/home.html?userid=" +result.userid + "&username=" + result.username;
                    }else{
                        $('#ResultLogin').attr('class', "text-danger");
                    }

                    $('#ResultLogin').text(result.msg);
               }
            });
        }

        //document.cookie =name + "=" + value + expire;
    </script>

    <!--Formulaire inscription-->
    <div class='row'>
        <div class="col-lg-offset-4 col-lg-4">
            <div class="well bs-component">
                <legend>Ou inscrivez vous : </legend>
                <form class="form-horizontal" id="loginForm"> <!--action="/tptwitter/login/" method="post"-->

                    <div class="form-group">
                        <label class="col-lg-2" for="newLogin">Login</label>
                        <div class="col-lg-10">
                            <input type="text" class="form-control" id="newLogin" name="newLogin" autofocus />
                        </div>
                    </div> 

                    <div class="form-group">
                        <label class="col-lg-2" for="newPasswd">Password</label>

                        <div class="col-lg-10">
                            <input type="password" class="form-control" id="newPasswd" name="newPasswd" autofocus />                        
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="col-lg-2" for="newPasswd2">Retype your Password</label>
                        <div class="col-lg-10">
                            <input type="password" class="form-control" id="newPasswd2" name="newPasswd2" autofocus />
                            <p id="ResultNewUser"> </p>
                        </div>
                    </div>
                    <button class="btn btn-primary btn-lg-2" type="button" onclick="newUserCheck()"> Submit </button>

                </form>
            </div>
        </div>
    </div>
    <script>
        function newUserCheck(){
           $.ajax({
               url : 'http://localhost:8000/tptwitter/newuser',
               type : 'POST',
               data : "newlogin=" + $('#newLogin').val() + "&newpasswd=" + $('#newPasswd').val() + "&newpasswd2=" + $('#newPasswd2').val(),
               success : function(result){
                    if(result.result){
                        $('#ResultNewUser').attr('class', "text-success");
                    }else{
                        $('#ResultNewUser').attr('class', "text-danger");
                    }
                    $('#ResultNewUser').text(result.msg);
               }
            });
        }
    </script>
    </body>
</html>
